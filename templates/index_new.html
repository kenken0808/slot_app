<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>けんけんスロット分析ツール</title>
</head>
<body>
  <h1>{{ machine_name }}</h1>

  <form method="POST" action="/tool">
    <label for="mode">モード</label>
    <select name="mode" id="mode">
      {% for opt in mode_options %}
        <option value="{{ opt }}" {% if selected_mode==opt %}selected{% endif %}>{{ opt }}</option>
      {% endfor %}
    </select>

    <label for="time">朝イチ／朝イチ以外</label>
    <select name="time" id="time">
      <option value="朝イチ" {% if selected_time=="朝イチ" %}selected{% endif %}>朝イチ</option>
      <option value="朝イチ以外" {% if selected_time=="朝イチ以外" %}selected{% endif %}>朝イチ以外</option>
    </select>

    <label for="through">スルー回数</label>
    <select name="through" id="through">
      {% for opt in through_options %}
        <option value="{{ opt }}" {% if selected_through==opt %}selected{% endif %}>{{ opt }}</option>
      {% endfor %}
    </select>

    <div id="advanced-section" style="display:grid;">
      {% for key, opts in detailed_options.items() %}
        <label for="{{ key }}">{{ key }}</label>
        <select name="{{ key }}" id="{{ key }}">
          {% for opt in opts %}
            <option value="{{ opt }}" {% if selected_values[key]==opt %}selected{% endif %}>{{ opt }}</option>
          {% endfor %}
        </select>
      {% endfor %}
    </div>

    <input type="submit" value="出力">
  </form>

  {% if result %}
    <h2>出力結果</h2>
    <ul>
      <li>件数: {{ result["件数"] }}</li>
      <li>平均REGゲーム数: {{ result["平均REGゲーム数"] }}</li>
      <li>平均AT枚数: {{ result["平均AT枚数"] }}</li>
      <li>機械割: {{ result["機械割"] }}</li>
      <li>期待値: {{ result["期待値"] }}</li>
    </ul>
  {% endif %}

</body>
</html>
